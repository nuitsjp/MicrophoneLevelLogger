# 目的

ノイズキャンセリングマイクのできるだけ定量的な評価をしたい。

そのうえで、LTをやって、情報共有に結び付ける。

情報共有的にはLTをやったことの情報共有。プロ貢献を育てていく上の参考。

ノイズキャンセリングを情報共有するわけではない。

# LTについて

C# TokyoのLT枠で実施

- ノイズキャンセリングマイクの比較
- 上記単独でもリモートワークエンジニア向けの情報共有として一応あり
- とはいえ、もう少し寄せられると良い
- ノイズキャンセリングを定量評価する
- そのためのツールをC#で開発してOSSとして公開する
- 1月の発表会向け

# ノイズキャンセリング

- マイクのノイズキャンセリング
- マイクが環境音を拾わずに、会話だけ拾ってくれるかどうかを評価する
- 環境音といっても色々あって
  - 電車の走行音
  - 工事現場の音
  - 喫茶店などの公共施設
  - ◎オフィス
  - ◎家族のいるリビング
- リモートワークを快適にするため

# やらないといけないこと

1. 定量評価のためのツール作成(12/23目標)
2. 計測と集計(12/30にやりたい)
3. 発表資料の作成(01/15くらい)
4. 情報共有資料の作成(01/31目標)

# 定量評価のためのツール作成

## どう評価しようか？

- どこで？
  - オフィス
- いつ？
  - 人が少なくて、人以外の環境音が同程度に保てるとき
- どうやって
  - スピーカーなどを使って、となりや背後で人がしゃべってる時と同程度の騒音を再現可能にする
  - 会議室から電車の音

## 定量的な評価ツールでできないといけないこと

- 各マイクの入力レベルがおおむね一致するように調整してあげる
  - 
- Windowsのマイクの入力値を一定間隔レコーディングして、平均値を求める

# 測定準備

1. [オフィスの環境音](https://sounddictionary.info/mp3/ambient/busy-office-1.mp3)をダウンロードし、55dB程度に調整する
2. 「吾輩は猫である.wav」を65dB程度に調整する


# 隣の人の音声

[VOICEVOX](https://voicevox.hiroshiba.jp/)の剣崎雌雄さんボイスで、「吾輩は猫である」の読み上げを利用。

# テスト方法

## ノイズキャンセリングのテスト

1. デバイスをPCに接続する。
    - 3.5mmイヤホンジャックのデバイスは1つしか接続できないので複数回に分ける。一番入力レベルが低いデバイスに合わせキャリブレーションする。
2. 各デバイスから1.5m～2m(隣の席から音が聞こえるイメージ)離した所に置いたスピーカーから音を出す。
3. ツールを使用して録音を開始する。
4. これをスピーカーの位置を変えて前後左右、4回行う。
5. 出力したCSVを加工し、測定結果グラフを作成する。

## ノイズ+人の声のテスト

1. デバイスをPCに接続する。
2. 音声通話をTeamsで開始し会議録画を行う。(PC-AとPC-B)
3. PC-Aに接続しているマイクから1.5m～2m離した所に置いたスピーカーから音を出す。
4. その状態で音声テストを行う。(吾輩は猫であるを流してもよいかも)
5. 録画を再生しノイズキャンセリングされているか、人の声がどのくらい鮮明に聞こえるかを確認する。

# 参考文献

- [C# Microphone Level Monitor](https://swharden.com/blog/2021-07-03-csharp-microphone/)


# ファイアウォールの開放

```cmd
netsh advfirewall firewall add rule name="Http Port 5000" dir=in action=allow protocol=TCP localport=5000
```